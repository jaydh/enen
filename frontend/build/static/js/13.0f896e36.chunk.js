(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{349:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r="https://backend.enen.io:4300"},565:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(347),a=n.n(r),i=n(348),o=n(349),c=n(352),s=n.n(c),u=function(e){return function(){var t=Object(i.a)(a.a.mark(function t(n){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s()({method:"POST",url:"".concat(o.a,"/article"),data:{url:e}}).then(function(e){return e.data}).catch(function(e){console.log(e)});case 2:t.sent;case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}},5963:function(e,t){},6319:function(e,t,n){"use strict";n.r(t);var r=n(433),a=n(347),i=n.n(a),o=n(348),c=n(35),s=n(36),u=n(38),l=n(37),m=n(39),d=n(1),f=n(554),p=n.n(f),h=n(26),v=n.n(h),g=n(27),E=n(352),b=n.n(E),k=n(349),y=n(53),S=n(21),T=n(5992),O=v()({delay:200,loader:function(){return n.e(2).then(n.t.bind(null,6e3,7))},loading:g.a}),w=v()({delay:200,loader:function(){return Promise.all([n.e(1),n.e(14)]).then(n.bind(null,6315))},loading:g.a}),L=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).getArticleData=function(){var e=Object(o.a)(i.a.mark(function e(t){var r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=n.props.article)||!r.HTMLData){e.next=5;break}e.t0={HTML:r.HTMLData,fetching:!1,url:r.url,metadata:r.metadata},e.next=8;break;case 5:return e.next=7,b()({method:"GET",url:"".concat(k.a,"/article/id"),params:{id:t}}).then(function(e){return e.data}).catch(function(e){console.log(e)});case 7:e.t0=e.sent;case 8:return e.abrupt("return",e.t0);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.transform=function(e,t){var r=n.props,a=r.classes,i=r.fontSize;return e.name&&e.name.startsWith("h")?d.createElement(y.B,{variant:e.name,gutterBottom:!0,align:"center"},Object(f.convertNodeToElement)(e,t,n.transform)):"img"===e.name?(e.attribs.class="img-fluid",d.createElement(y.m,{container:!0,item:!0,justify:"center",className:a.image},Object(f.convertNodeToElement)(e,t,n.transform))):"p"===e.name?d.createElement(y.B,{paragraph:!0,inline:!0,style:{fontSize:i}},Object(f.convertNodeToElement)(e,t,n.transform)):"pre"===e.name?d.createElement("div",{className:a.pre},d.createElement(O,null,Object(f.convertNodeToElement)(e))):"blockquote"===e.name?d.createElement("div",{className:a.quote},e.children.map(function(e){return d.createElement(y.B,{style:{fontSize:i}},e.data?e.data:null)})):"a"===e.name&&e.children&&e.children[0]&&e.children[0].data?d.createElement(w,{hyperlinkName:e.children[0].data,url:e.attribs.href}):void 0},n.getBookmark=function(){var e=n.state.articleNodeList,t=n.props.match.params.id;if(e)for(var r=0,a=e.length;r<a;r++){var i=e[r];if(n.elementInView(i)){var o=e[r>0?r-1:r].textContent;if(o&&o!==n.props.article.bookmark)return void n.props.updateBookmark(t,o)}}},n.getArticlesInView=function(){var e=n.state.requestedParses;n.state.articleLinks.filter(function(e){return n.elementInView(e)}).forEach(function(){var t=Object(o.a)(i.a.mark(function t(a){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.find(function(e){return e===a.href})||(n.setState({requestedParses:[].concat(Object(r.a)(n.state.requestedParses),[a.href])}),n.props.requestServerParse(a.href));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())},n.elementInView=function(e){var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)},n.scrollToBookmark=function(){var e=n.state.articleNodeList,t=n.props.article.bookmark;if(e){var r=Array.from(e).find(function(e){return e.textContent===t});r&&r.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})}},n.getProgress=function(){var e=document.getElementById("main");if(e){var t=n.props.match.params.id,r=document.body,a="scrollTop",i="scrollHeight",o=(e[a]||r[a])/((e[i]||r[i])-e.clientHeight)*100;o!==n.state.progress&&(n.props.updateProgress(t,o),n.setState({progress:o}))}},n.state={articleLinks:[],articleNodeList:[],fetching:!0,intervalId:null,requestedParses:[]},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=Object(o.a)(i.a.mark(function e(){var t,n,r,a,o,c,s=this;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.match.params.id,e.next=3,this.getArticleData(t);case 3:return n=e.sent,r=n.HTML,a=n.url,o=n.metadata,this.props.updateLastArticle(n),this.setState({HTML:r,url:a,metadata:o,fetching:!1}),document.title+=" - ".concat(o.title),e.next=10,this.setState({articleLinks:Array.from(document.querySelectorAll("div.page a")),articleNodeList:Array.from(document.querySelectorAll("div.page p")).filter(function(e){return e.textContent})});case 10:this.props.article&&(c=setInterval(function(){s.getBookmark(),s.getProgress(),s.getArticlesInView()},5e3),this.scrollToBookmark(),this.setState({intervalId:c}));case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){clearInterval(this.state.intervalId),document.title="enen"}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.fontSize,r=this.state,a=r.HTML,i=r.fetching,o=r.metadata,c=r.url,s=a&&T.decode(a),u=o&&(o.title||o.ogTitle)?o.title||o.ogTitle:c,l=o&&(o.siteName||o.ogSiteName),m=o&&o.excerpt,f="".concat(l||""," ").concat(m?"-"+m:"");return i||s?d.createElement(y.m,{container:!0,alignItems:"center",justify:"center"},d.createElement(y.m,{item:!0,xs:12,sm:12,md:8,lg:8,className:t.root},d.createElement(y.y,{elevation:10,className:t.root},d.createElement(y.B,{style:{fontSize:n+10},variant:"title"},u),d.createElement(y.B,{style:{fontSize:n+2},variant:"subtitle1"},f),d.createElement(y.h,{className:t.title}),d.createElement("div",null,i?d.createElement(g.a,{pastDelay:!1,isLoading:i}):d.createElement("div",{style:{fontSize:n,lineHeight:"1.5"}},p()(s,{decodeEntities:!1,transform:this.transform})))))):d.createElement(y.m,{container:!0,alignItems:"center",justify:"center"},d.createElement(y.B,{variant:"h3"},"Unavailable"))}}]),t}(d.Component),A=Object(S.withStyles)({image:{padding:"1em"},pre:{borderLeft:"4px outset gray",margin:"2em",paddingLeft:"1em"},quote:{borderLeft:"4px outset purple",margin:"2em",paddingLeft:"1em"},root:{padding:"2em 1em"},title:{marginBottom:"4em"}})(L),P=n(74),j=n(16);function B(e,t){return{bookmark:t,id:e,type:"UPDATE_BOOKMARK_FULFILLED"}}function D(e,t){return function(){var n=Object(o.a)(i.a.mark(function n(r,a){var o;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return o=a().user.token,r({type:"UPDATE_BOOKMARK_REQUESTED"}),n.abrupt("return",b()({method:"POST",url:"".concat(k.a,"/user/bookmark"),headers:{Authorization:"Bearer ".concat(o)},data:{id:e,bookmark:t}}).then(function(n){return r(B(e,t))}).catch(function(e){return r({reason:e,type:"UPDATE_BOOKMARK_REJECTED"})}));case 3:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}()}var x=function(e){return{type:"UPDATE_LAST_ARTICLE",article:e}};function I(e,t){return{id:e,progress:t,type:"UPDATE_PROGRESS_FULFILLED"}}function N(e,t){return function(){var n=Object(o.a)(i.a.mark(function n(r,a){var o;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return o=a().user.token,r({type:"UPDATE_PROGRESS_REQUESTED"}),n.abrupt("return",b()({method:"POST",url:"".concat(k.a,"/user/progress"),headers:{Authorization:"Bearer ".concat(o)},data:{id:e,progress:t}}).then(function(n){r(I(e,t))}).catch(function(e){return r({reason:e,type:"UPDATE_PROGRESS_REJECTED"})}));case 3:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}()}var R=n(565);t.default=Object(P.b)(function(e,t){return{fontSize:e.ui.fontSize,uid:e.user.uid,article:e.articles.articleData[t.match.params.id]}},function(e){return Object(j.bindActionCreators)({updateLastArticle:x,updateBookmark:D,updateProgress:N,requestServerParse:R.a},e)})(A)}}]);
//# sourceMappingURL=13.0f896e36.chunk.js.map