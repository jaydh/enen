(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{343:function(e,t,r){"use strict";r.d(t,"a",function(){return n});var n=""},461:function(e,t,r){"use strict";r.d(t,"a",function(){return u});var n=r(341),a=r.n(n),i=r(342),o=r(343),c=r(344),s=r.n(c),u=function(e){return function(){var t=Object(i.a)(a.a.mark(function t(r){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s()({method:"POST",url:"".concat(o.a,"/article"),data:{url:e}}).then(function(e){return e.data}).catch(function(e){console.log(e)});case 2:t.sent;case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}},5818:function(e,t){},6038:function(e,t,r){"use strict";r.r(t);var n=r(364),a=r(341),i=r.n(a),o=r(342),c=r(35),s=r(36),u=r(38),l=r(37),m=r(39),d=r(1),f=r(446),p=r.n(f),h=r(33),v=r.n(h),g=r(34),E=r(344),b=r.n(E),k=r(343),y=r(53),S=r(21),T=r(5836),O=v()({delay:200,loader:function(){return r.e(2).then(r.t.bind(null,5845,7))},loading:g.a}),w=v()({delay:200,loader:function(){return Promise.all([r.e(1),r.e(12)]).then(r.bind(null,6035))},loading:g.a}),L=function(e){function t(e){var r;return Object(c.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,e))).getArticleData=function(){var e=Object(o.a)(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=r.props.article)||!n.HTMLData){e.next=5;break}e.t0={HTML:n.HTMLData,fetching:!1,url:n.url,metadata:n.metadata},e.next=8;break;case 5:return e.next=7,b()({method:"GET",url:"".concat(k.a,"/article/id"),params:{id:t}}).then(function(e){return e.data}).catch(function(e){console.log(e)});case 7:e.t0=e.sent;case 8:return e.abrupt("return",e.t0);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),r.transform=function(e,t){var n=r.props,a=n.classes,i=n.fontSize;return e.name&&e.name.startsWith("h")?d.createElement(y.B,{variant:e.name,gutterBottom:!0,align:"center"},Object(f.convertNodeToElement)(e,t,r.transform)):"img"===e.name?(e.attribs.class="img-fluid",d.createElement(y.m,{container:!0,item:!0,justify:"center",className:a.image},Object(f.convertNodeToElement)(e,t,r.transform))):"p"===e.name?d.createElement(y.B,{paragraph:!0,inline:!0,style:{fontSize:i}},Object(f.convertNodeToElement)(e,t,r.transform)):"pre"===e.name?d.createElement("div",{className:a.pre},d.createElement(O,null,Object(f.convertNodeToElement)(e))):"blockquote"===e.name?d.createElement("div",{className:a.quote},e.children.map(function(e){return d.createElement(y.B,{style:{fontSize:i}},e.data?e.data:null)})):"a"===e.name&&e.children&&e.children[0]&&e.children[0].data?d.createElement(w,{hyperlinkName:e.children[0].data,url:e.attribs.href}):void 0},r.getBookmark=function(){var e=r.state.articleNodeList,t=r.props.match.params.id;if(e)for(var n=0,a=e.length;n<a;n++){var i=e[n];if(r.elementInView(i)){var o=e[n>0?n-1:n].textContent;if(o&&o!==r.props.article.bookmark)return void r.props.updateBookmark(t,o)}}},r.getArticlesInView=function(){var e=r.state.requestedParses;r.state.articleLinks.filter(function(e){return r.elementInView(e)}).forEach(function(){var t=Object(o.a)(i.a.mark(function t(a){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.find(function(e){return e===a.href})||(r.setState({requestedParses:[].concat(Object(n.a)(r.state.requestedParses),[a.href])}),r.props.requestServerParse(a.href));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())},r.elementInView=function(e){var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)},r.scrollToBookmark=function(){var e=r.state.articleNodeList,t=r.props.article.bookmark;if(e){var n=Array.from(e).find(function(e){return e.textContent===t});n&&n.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})}},r.getProgress=function(){var e=document.getElementById("main");if(e){var t=r.props.match.params.id,n=document.body,a="scrollTop",i="scrollHeight",o=(e[a]||n[a])/((e[i]||n[i])-e.clientHeight)*100;o!==r.state.progress&&(r.props.updateProgress(t,o),r.setState({progress:o}))}},r.state={articleLinks:[],articleNodeList:[],fetching:!0,intervalId:null,requestedParses:[]},r}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=Object(o.a)(i.a.mark(function e(){var t,r,n,a,o,c,s=this;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.match.params.id,e.next=3,this.getArticleData(t);case 3:return r=e.sent,n=r.HTML,a=r.url,o=r.metadata,this.props.updateLastArticle(r),this.setState({HTML:n,url:a,metadata:o,fetching:!1}),document.title+=" - ".concat(o.title),e.next=10,this.setState({articleLinks:Array.from(document.querySelectorAll("div.page a")),articleNodeList:Array.from(document.querySelectorAll("div.page p")).filter(function(e){return e.textContent})});case 10:this.props.article&&(c=setInterval(function(){s.getBookmark(),s.getProgress(),s.getArticlesInView()},5e3),this.scrollToBookmark(),this.setState({intervalId:c}));case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){clearInterval(this.state.intervalId),document.title="enen"}},{key:"render",value:function(){var e=this.props,t=e.classes,r=e.fontSize,n=this.state,a=n.HTML,i=n.fetching,o=n.metadata,c=n.url,s=a&&T.decode(a),u=o&&(o.title||o.ogTitle)?o.title||o.ogTitle:c,l=o&&(o.siteName||o.ogSiteName),m=o&&o.excerpt,f="".concat(l||""," ").concat(m?"-"+m:"");return i||s?d.createElement(y.m,{container:!0,alignItems:"center",justify:"center"},d.createElement(y.m,{item:!0,xs:12,sm:12,md:8,lg:8,className:t.root},d.createElement(y.y,{elevation:10,className:t.root},d.createElement(y.B,{style:{fontSize:r+10},variant:"title"},u),d.createElement(y.B,{style:{fontSize:r+2},variant:"subtitle1"},f),d.createElement(y.h,{className:t.title}),d.createElement("div",null,i?d.createElement(g.a,{pastDelay:!1,isLoading:i}):d.createElement("div",{style:{fontSize:r,lineHeight:"1.5"}},p()(s,{decodeEntities:!1,transform:this.transform})))))):d.createElement(y.m,{container:!0,alignItems:"center",justify:"center"},d.createElement(y.B,{variant:"h3"},"Unavailable"))}}]),t}(d.Component),A=Object(S.withStyles)({image:{padding:"1em"},pre:{borderLeft:"4px outset gray",margin:"2em",paddingLeft:"1em"},quote:{borderLeft:"4px outset purple",margin:"2em",paddingLeft:"1em"},root:{padding:"2em 1em"},title:{marginBottom:"4em"}})(L),P=r(74),j=r(15);function B(e,t){return{bookmark:t,id:e,type:"UPDATE_BOOKMARK_FULFILLED"}}function D(e,t){return function(){var r=Object(o.a)(i.a.mark(function r(n,a){var o;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return o=a().user.token,n({type:"UPDATE_BOOKMARK_REQUESTED"}),r.abrupt("return",b()({method:"POST",url:"".concat(k.a,"/user/bookmark"),headers:{Authorization:"Bearer ".concat(o)},data:{id:e,bookmark:t}}).then(function(r){return n(B(e,t))}).catch(function(e){return n({reason:e,type:"UPDATE_BOOKMARK_REJECTED"})}));case 3:case"end":return r.stop()}},r)}));return function(e,t){return r.apply(this,arguments)}}()}var x=function(e){return{type:"UPDATE_LAST_ARTICLE",article:e}};function I(e,t){return{id:e,progress:t,type:"UPDATE_PROGRESS_FULFILLED"}}function N(e,t){return function(){var r=Object(o.a)(i.a.mark(function r(n,a){var o;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return o=a().user.token,n({type:"UPDATE_PROGRESS_REQUESTED"}),r.abrupt("return",b()({method:"POST",url:"".concat(k.a,"/user/progress"),headers:{Authorization:"Bearer ".concat(o)},data:{id:e,progress:t}}).then(function(r){n(I(e,t))}).catch(function(e){return n({reason:e,type:"UPDATE_PROGRESS_REJECTED"})}));case 3:case"end":return r.stop()}},r)}));return function(e,t){return r.apply(this,arguments)}}()}var R=r(461);t.default=Object(P.b)(function(e,t){return{fontSize:e.ui.fontSize,uid:e.user.uid,article:e.articles.articleData[t.match.params.id]}},function(e){return Object(j.bindActionCreators)({updateLastArticle:x,updateBookmark:D,updateProgress:N,requestServerParse:R.a},e)})(A)}}]);
//# sourceMappingURL=11.92f41908.chunk.js.map